package main

import (
	"fmt"
	"math/rand"
)

func (b *Board) AddPatternFromString(offsetx, offsety int, pattern string) {
	var x, y int
	for _, c := range pattern {
		x++
		switch c {
		case '\n':
			x = 0
			y++
		case 'O':
			b.Set(x+offsetx, y+offsety, true)
		}
	}
}

func (b *Board) AddRandom(int, int) {
	for y, l := range b.elements {
		for x := range l {
			b.Set(x, y, rand.Intn(2) == 1)
		}
	}
}

func (b *Board) AddBeehive(x, y int) error {
	if b.dimx-x < 2 || b.dimy-y < 2 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for beehive at (%d, %d)", b.dimx, b.dimy, x, y)
	}

	coords := [][]int{{1, 0},
		{0, 1}, {2, 1},
		{0, 2}, {2, 2},
		{1, 3}}
	for _, c := range coords {
		b.Set(x+c[0], y+c[1], true)
	}
	return nil
}

func (b *Board) AddBlinker(x, y int) error {
	if b.dimx-x < 5 || b.dimy-y < 5 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for blinker at (%d, %d)", b.dimx, b.dimy, x, y)
	}

	coords := [][]int{{2, 3}, {3, 3}, {4, 3}}
	for _, c := range coords {
		b.Set(x+c[0], y+c[1], true)
	}
	return nil
}

func (b *Board) AddGlider(x, y int) error {
	if b.dimx+x < 2 || b.dimy+y < 2 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for glider at (%d, %d)", b.dimx, b.dimy, x, y)
	}

	coords := [][]int{{0, 1}, {1, 2}, {2, 0}, {2, 1}, {2, 2}}
	for _, c := range coords {
		b.Set(x+c[0], y+c[1], true)
	}
	return nil
}

func (b *Board) AddGliderGun(x, y int) error {
	if b.dimx-x < 37 || b.dimy-y < 9 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for FPentomino at (%d, %d)", b.dimx, b.dimy, x, y)
	}
	pattern := `........................O...........
......................O.O...........
............OO......OO............OO
...........O...O....OO............OO
OO........O.....O...OO..............
OO........O...O.OO....O.O...........
..........O.....O.......O...........
...........O...O....................
............OO......................`
	b.AddPatternFromString(x, y, pattern)
	return nil
}

func (b *Board) AddGliderGun2(x, y int) error {
	if b.dimx-x < 40 || b.dimy-y < 26 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for FPentomino at (%d, %d)", b.dimx, b.dimy, x, y)
	}
	pattern := `............................O..........
............................O.O........
...........OO..................OO......
.........O...O.................OO....OO
...OO...O.....O................OO....OO
...OO..OO.O...O.............O.O........
........O.....O.............O..........
.........O...O.........................
...........OO..........................
.......................................
.......................................
.......................................
.......................................
.......................................
.......................................
.......................................
..........O.O..........................
.........O..O...OO.....................
OO......OO.....OOO.OO..OO..............
OO....OO...O...O...O...O.O.............
........OO.....O.O........O............
.........O..O..OO......O..O............
..........O.O.............O............
.......................O.O.......OO....
.......................OO........O.O...
...................................O...
...................................OO..`
	b.AddPatternFromString(x, y, pattern)
	return nil
}

func (b *Board) AddReflector(x, y int) error {
	if b.dimx-x < 9 || b.dimy-y < 21 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for Reflector at (%d, %d)", b.dimx, b.dimy, x, y)
	}
	pattern := `........O
......OOO
.....O...
.....OO..
.........
.........
.........
.........
.........
.........
.........
OO.O.OO..
.........
O.....O..
.........
.OO.OO...
...O.....
.........
.........
.........
.........
...OO....
...OO....`
	b.AddPatternFromString(x, y, pattern)
	return nil
}

func (b *Board) AddSuicide(x, y int) error {
	if b.dimx-x < 9 || b.dimy-y < 8 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for Suicide pattern at (%d, %d)", b.dimx, b.dimy, x, y)
	}
	pattern := `.........
...OOO...
...O.O...
...O.O...
.........
...O.O...
...O.O...
...OOO...
.........`
	b.AddPatternFromString(x, y, pattern)
	return nil
}

func (b *Board) AddFPentomino(x, y int) error {
	if b.dimx-x < 5 || b.dimy-y < 4 {
		return fmt.Errorf("board dimensions (%d, %d) are too small for FPentomino at (%d, %d)", b.dimx, b.dimy, x, y)
	}
	pattern := `.....
..OO.
.OO..
..O..
.....`
	b.AddPatternFromString(x, y, pattern)
	return nil
}
